<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Haozhe Sun&#39;s site">
<meta property="og:url" content="https://haozhesun.github.io/index.html">
<meta property="og:site_name" content="Haozhe Sun&#39;s site">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Haozhe Sun">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://haozhesun.github.io/"/>





  <title>Haozhe Sun's site</title>
  








<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Haozhe Sun's site</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/17/ZooKeeper-Wait-free-coordination-for-Internet-scale-systems/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/17/ZooKeeper-Wait-free-coordination-for-Internet-scale-systems/" itemprop="url">ZooKeeper: Wait-free coordination for Internet-scale systems</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-17T10:17:48-05:00">
                2023-01-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Paper-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Paper Note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a target="_blank" rel="noopener" href="https://www.usenix.org/legacy/events/atc10/tech/full_papers/Hunt.pdf">https://www.usenix.org/legacy/events/atc10/tech/full_papers/Hunt.pdf</a></p>
<p>ZooKeeper provides an API that enables application developers to implement their own primitives<br>Zookeeper implements an API that manipulates simple waitfree data objects organized hierarchically as in file systems, instead of useing blocking primitives, such as locks.<br>Blocking primitives for a coordination service can cause slow or faulty clients to impact negatively the performance of faster clients.<br>FIFO client ordering of all operations and linearizable writes enables an efficient implementation of the service and it is sufficient to implement coordination primitives of interest to our applications.<br>ZooKeeper uses a simple pipelined architecture allows to have hundreds or thousands of requests outstanding while still achieving low latency.<br>Such a pipeline enables the execution of operations from a single client in FIFO order.<br>implement a leader-based atomic broadcast protocol, called Zab, To guarantee that update operations satisfy linearizability<br>In ZooKeeper, servers process read operations locally, and we do not use Zab to totally order them.<br>ZooKeeper uses a watch mechanism to enable clients to cache data without managing the client cache directly.<br>znode is an in-memory data node in the ZooKeeper data, which is organized in a hierarchical namespace referred to as the data tree.<br>ZooKeeper provides to its clients the abstraction of a set of data nodes (znodes), organized according to a hierarchical name space.<br>Use the standard UNIX notation for file system paths. For example, we use &#x2F;A&#x2F;B&#x2F;C to denote the path to znode C, where C has B as its parent and B has A as its parent. All znodes store data, and all znodes, except for ephemeral znodes, can have children.<br>There are two types of znodes that a client can create:<br>Regular: Clients manipulate regular znodes by creating and deleting them explicitly;<br>Ephemeral: Clients create such znodes, and they either delete them explicitly, or let the system remove them automatically when the session that creates them terminates (deliberately or due to a failure).<br>When a client issues a read operation with a watch flag set, the operation completes as normal except that the server promises to notify the client when the information returned has changed<br>Watches are unregistered once triggered or the session closes, do not provide the change<br>znodes map to abstractions of the client application, typically corresponding to meta-data used for coordination purposes.<br>An application uses the synchronous API when it needs to execute a single ZooKeeper operation and it has no concurrent tasks to execute<br>The asynchronous API enables an application to have both multiple outstanding ZooKeeper operations and other tasks executed in parallel.</p>
<p>ZooKeeper has two basic ordering guarantees:<br>Linearizable writes: all requests that update the state of ZooKeeper are serializable and respect precedence; allow a client to have multiple outstanding operations, guarantee FIFO order.<br>FIFO client order: all requests from a given client are executed in the order that they were sent by the client.<br>With ZooKeeper, the new leader can designate a path as the ready znode; other processes will only use the configuration when that znode exists. new leader makes the configuration change by deleting ready, updating configuration znodes, and creating ready.</p>
<p>Configuration Management<br>Starting processes obtain their configuration by reading zc with the watch flag set to true. if zc is ever updated, the processes are notified and read the new configuration, again setting the watch flag to true.</p>
<p>Rendezvous<br>Client create a rendezvous znode, zr, passes the full pathname of zr as a startup parameter of the master and worker processes<br>When the master starts it fills in zr with information about addresses and ports it is using. When workers start, they read zr with watch set to true. If zr has not been filled in yet, the worker waits to be notified when zr is updated.<br>If zr is an ephemeral node, master and worker processes can watch for zr to be deleted and clean themselves up when the client ends.</p>
<p>Group Membership<br>Use a znode, zg to represent the group. When a process member of the group starts, it creates an ephemeral child znode under zg.<br>If the process fails or ends, the znode that represents it under zg is automatically removed.<br>Processes can obtain group information by simply listing the children of zg.</p>
<p>Simple Locks<br>A client tries to create the designated znode with the EPHEMERAL flag to acquire a lock.<br>If create fail, the client can read the znode with the watch flag set to be notified if the current leader dies.<br>A client releases the lock when it dies or explicitly deletes the znode.<br>problems:<br>suffers from the herd effect, all client waiting will try to acquire lock when available.<br>only implements exclusive locking</p>
<p>Simple Locks without Herd Effect<br>Lock<br>1 n &#x3D; create(l + “&#x2F;lock-”, EPHEMERAL|SEQUENTIAL)<br>2 C &#x3D; getChildren(l, false)<br>3 if n is lowest znode in C, exit<br>4 p &#x3D; znode in C ordered just before n<br>5 if exists(p, true) wait for watch event<br>6 goto 2<br>Unlock<br>1 delete(n)<br>A client create the znode with the EPHEMERAL and SEQUENTIAL flag.<br>The use of the SEQUENTIAL flag orders the client’s attempt to acquire the lock<br>If the client’s znode has the lowest sequence number the client holds the lock.<br>advantages:<br>removal of a znode only causes one client to wake up, no herd effect<br>no polling or timeouts<br>can see by browsing the ZooKeeper data the amount of lock contention, break locks, and debug locking problems.</p>
<p>Read&#x2F;Write Locks<br>Write Lock<br>1 n &#x3D; create(l + “&#x2F;write-”, EPHEMERAL|SEQUENTIAL)<br>2 C &#x3D; getChildren(l, false)<br>3 if n is lowest znode in C, exit<br>4 p &#x3D; znode in C ordered just before n<br>5 if exists(p, true) wait for event<br>6 goto 2</p>
<p>Read Lock<br>1 n &#x3D; create(l + “&#x2F;read-”, EPHEMERAL|SEQUENTIAL)<br>2 C &#x3D; getChildren(l, false)<br>3 if no write znodes lower than n in C, exit<br>4 p &#x3D; write znode in C ordered just before n    &#x2F;&#x2F;only earlier write lock znodes prevent the client from obtaining a read lock.<br>5 if exists(p, true) wait for event<br>6 goto 3</p>
<p>Double Barrier<br>Use a znode b as barrier.<br>Every process p registers with b by creating a znode as a child of b on entry<br>unregisters – removes the child – when it is ready to leave (finished computation).<br>Processes can enter the barrier (start computation) when the number of child znodes of b exceeds the barrier threshold. Processes can leave the barrier when all of the processes have removed their children.<br>to enter, processes watch for the existence of a ready child of b that will be created by the process that causes the number of children to exceed the barrier threshold.<br>To leave, processes watch for a particular child to disappear after their znode has been removed.</p>
<p>ZooKeeper Applications</p>
<p>The Fetching Service<br>The Fetching Service uses ZooKeeper mainly to manage configuration metadata, also uses ZooKeeper to elect masters (leader election).<br>Advantages of using ZooKeeper for FS are recovering from failures of masters, guaranteeing availability despite failures, and decoupling the clients from the servers, allowing them to direct their request to healthy servers by just reading their status from ZooKeeper<br>the read:write ratio varies between 10:1 and 100:1. </p>
<p>Katta<br>Katta uses ZooKeeper to track the status of slave servers and the master (group membership), and to handle master failover (leader election), track and propagate the assignments of shards to slaves (configuration management).</p>
<p>Yahoo! Message Broker<br>YMB uses ZooKeeper to manage the distribution of topics (configuration metadata), deal with failures of machines in the system (failure detection and group membership), and control system operation.<br><img src="/images/YMB.png" alt="YMB"><br>Each YMB server creates an ephemeral znode under nodes with load and status information providing both group membership and status information through ZooKeeper.<br>primary and backup server znodes allow servers to discover the servers in charge of a topic and manage leader election and server crashes</p>
<p><strong>ZooKeeper Implementation</strong><br>ZooKeeper provides availability by replicating the ZooKeeper data on each server that composes the service.<br>they use an agreement protocol for write requests (atomic broadcast)<br>a server simply reads the state of the local database for read requests<br>replicated database is an in-memory database containing the entire data tree<br>log updates to disk, and we force writes to be on the disk media before they are applied to the in-memory database<br>keep a replay log (a write-ahead log, in our case) of committed operations and generate periodic snapshots of the in-memory database<br>write requests are forwarded to a single server, called the leader, followers receive message proposals consisting of state changes from the leader and agree upon state changes.</p>
<p>ZooKeeper use atomic broadcast protocol Zab<br>use TCP for our transport so message order is maintained by the network<br>use the leader chosen by Zab as the ZooKeeper leader, so that the same process that creates transactions also proposes them<br>use the log to keep track of proposals as the write-ahead log for the in memory database, so that we do not have to write messages twice to disk.<br>recovers from a crash<br>ZooKeeper uses periodic snapshots and only requires redelivery of messages since the start of the snapshot.<br>servers handle notifications locally. Only the server that a client is connected to tracks and triggers notifications for that client</p>
<p>Increasing number of servers increase reads throughput and decrease writes throughput, since read operate on single server, write needs atomic broadcast.<br>ZooKeeper is able to achieve such high throughput by distributing load across the servers that makeup the service.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/16/In-Search-of-an-Understandable-Consensus-Algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/16/In-Search-of-an-Understandable-Consensus-Algorithm/" itemprop="url">In Search of an Understandable Consensus Algorithm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-16T04:10:12-05:00">
                2023-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Paper-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Paper Note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a target="_blank" rel="noopener" href="https://www.usenix.org/system/files/conference/atc14/atc14-paper-ongaro.pdf">https://www.usenix.org/system/files/conference/atc14/atc14-paper-ongaro.pdf</a><br>In Search of an Understandable Consensus Algorithm is a paper wrote by Diego Ongaro and John Ousterhout from Stanford University.</p>
<p>This paper proposed a consensus algorithm called Raft, which is more understandable than classic Paxos algorithm.</p>
<p>Consensus algorithms allow a cluster of machines to work together and can survive from failures of some members, they play a key role in building reliable large-scale software systems because of this.</p>
<p>Due to Paxos algorithm is to hard to understand, this paper set their primary goal to be understandability. “In designing Raft we applied specific techniques to improve understandability, including decomposition (Raft separates leader election, log replication, and safety) and state space reduction (relative to Paxos, Raft reduces the degree of nondeterminism and the ways servers can be inconsistent with each other).”</p>
<p>They make a user study with 43 students from two universities, by letting student answer questions after learing Raft and Paxos, they claim Raft is significantly easier to understand than Paxos.</p>
<p>Novel features:<br>Strong leader: log only flow from leader to other servers.<br>Leader election: use randomized timers to elect leaders.<br>Membership changes: use a new joint consensus approach where the majorities of two different configurations overlap during transitions, allows the cluster to continue operating normally during configuration changes.</p>
<p>Replicated state machines<br>Replicated state machines are used to solve a variety of fault tolerance problems in distributed systems.<br>Replicated state machines are typically implemented using a replicated log.  Each server stores a log containing a series of commands, which its state machine executes in order. Each log contains the same commands in the same order, so each state machine processes the same sequence of commands.<br>Keeping the replicated log consistent is the job of the consensus algorithm. The consensus module on a server receives commands from clients and adds them to its log, communicates with the consensus modules on other servers to ensure that every log eventually contains the same requests in the same order, even if some servers fail.<br>Properties of consensus algorithms<br>Safety: never return incorrect result<br>Avaiable: can be fully functional as long as majority of servers are operational<br>do not depend on timing to ensure the consistency of the logs<br>a command can complete as soon as a majority of the cluster has responded</p>
<p>Raft<br>First elect a distinguished leader, then give the leader complete responsibility for managing the replicated log. The leader accepts log entries from clients, replicates them on other servers, and tells servers when it is safe to apply log entries to their state machines. A new leader is elected when the leader fail or disconnected.</p>
<p>A Raft cluster contains several servers. At any given time each server is in one of three states: leader, follower, or candidate.<br>The leader handles all client requests, Followers only respond to leaders and candidates, candidate, is used to elect a new leader.<br>Each term begins with an election, when a candidate wins the election, then it serves as leader for the rest of the term.<br>Each server stores a current term number, Current terms are exchanged whenever servers communicate; if one server’s current term is smaller than the other’s, then it updates its current term to the larger value. If a candidate or leader discovers that its term is out of date, it immediately reverts to follower state. If a server receives a request with a stale term number, it rejects the request.</p>
<p>When servers start up, they begin as followers.  Leaders send periodic heartbeats (AppendEntries RPCs that carry no log entries) to all followers in order to maintain their authority. If a follower receives no communication over a period of time called the election timeout, then it assumes there is no viable leader and begins an election to choose a new leader.<br>To begin an election, a follower increments its current term and transitions to candidate state. It then votes for itself and issues RequestVote RPCs in parallel to each of the other servers in the cluster. A candidate continues in this state until one of three things happens: (a) it wins the election, (b) another server establishes itself as leader, or (c) a period of time goes by with no winner.<br>A candidate wins an election if it receives votes from a majority of the servers in the full cluster for the same term. Each server will vote for at most one candidate in a given term, on a first-come-first-served basis.<br>While waiting for votes, a candidate may receive an AppendEntries RPC from another server claiming to be leader. If the leader’s term (included in its RPC) is at least as large as the candidate’s current term, then the candidate recognizes the leader as legitimate and returns to follower state. If the term in the RPC is smaller than the candidate’s current term, then the candidate rejects the RPC and continues in candidate state.<br>If no candidate wins, start another vote after timeout.<br>Raft uses randomized election timeouts from a fixed interval to ensure that split votes are rare and that they are resolved quickly.</p>
<p>The leader append client requests to its log as new entry, then issues AppendEntries RPCs in parallel to each of the other servers to replicate the entry. When majority of the servers replicated the entry, the leader apply the entry and entries before that entry to the state machine and returns the result to client and is called committed. The leader retries AppendEntries RPCs indefinitely until all followers eventually store all log entries.</p>
<p>Each log entry stores a state machine command along with the term number when the entry was received by the leader, an integer index identifying its position in the log.<br>The leader handles inconsistencies by forcing the followers’ logs to duplicate its own. This means that conflicting entries in follower logs will be overwritten with entries from the leader’s log.</p>
<p>The leader maintains a nextIndex for each follower, which is the index of the next log entry the leader will send to that follower. When a leader first comes to power, it initializes all nextIndex values to the index just after the last one in its log.  If a follower’s log is inconsistent with the leader’s, the AppendEntries consistency check will fail in the next AppendEntries RPC. After a rejection, the leader decrements nextIndex and retries the AppendEntries RPC.</p>
<p>A candidate need vote from majority of servers (at least one of these severs has all committed entries), and it only received vote when it is at least up-to-date with that server.<br>Raft determines which of two logs is more up-to-date by comparing the index and term of the last entries in the logs. If the logs have last entries with different terms, then<br>the log with the later term is more up-to-date. If the logs end with the same term, then whichever log is longer is more up-to-date.</p>
<p>Only log entries from the leader’s current term are committed by counting replicas; once an entry from the current term has been committed in this way, then all prior entries are committed indirectly because of the Log Matching Property.</p>
<p>A committed entry is replicated in majority of servers, and a candidate need a majority votes to be the leader, so it has to contain all committed entries to get enough votes.</p>
<p>When follower or candidate crashes, Raft retry requests indefinitely.</p>
<p>If message exchanges take longer than the typical time between server crashes, candidates will not stay up long enough to win an election; without a steady leader, Raft cannot make progress.<br>Raft will be able to elect and maintain a steady leader as long as the system satisfies the following timing requirement:<br>broadcastTime ≪ electionTimeout ≪ MTBF<br>broadcastTime is the average time it takes a server to send RPCs in parallel to every server in the cluster and receive their responses<br>MTBF is the average time between failures for a single server.</p>
<p>Cluster membership changes<br>In Raft the cluster first switches to a transitional configuration we call joint consensus; once the joint consensus has been committed, the system then transitions to the new configuration.<br>• Log entries are replicated to all servers in both configurations.<br>• Any server from either configuration may serve as leader.<br>• Agreement (for elections and entry commitment) requires separate majorities from both the old and new configurations.<br>When the leader receives a request to change the configuration from Cold to Cnew, it stores the configuration for joint consensus (Cold,new in the figure) as a log entry and replicates that entry. A server always uses the latest configuration in its log.  If the leader crashes, a new leader may be chosen under either Cold or Cold,new, depending on whether the winning candidate has received Cold,new. In any case, Cnew cannot make unilateral decisions during this period.<br>Once Cold,new has been committed, neither Cold nor Cnew can make decisions without approval of the other. It is now safe for the leader to create a log entry describing Cnew and replicate it to the cluster.</p>
<p>Before the configuration change, the new servers join the cluster as non-voting members (the leader replicates log entries to them, but they are not considered for majorities). Once the new servers have caught up with the rest of the cluster, the reconfiguration can proceed.</p>
<p>If leader is not part of new configuration, the leader steps down (returns to follower state) once it has committed the Cnew log entry. it replicates log entries but does not count itself in majorities</p>
<p>To avoid removed servers to start elections, servers disregard RequestVote RPCs when they believe a current leader exists. if a server receives a RequestVote RPC within the minimum election timeout of hearing from a current leader, it does not update its term or grant its vote.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/07/131-Palindrome-Partitioning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/07/131-Palindrome-Partitioning/" itemprop="url">131. Palindrome Partitioning</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-07T15:31:22-05:00">
                2023-01-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Given a string s, partition s such that every substring of the partition is a palindrome. Return all possible palindrome partitioning of s.</p>
<p>Use backtracking, where takes string s, index start, and list p as argument.<br>Start indicate the start index of the string that haven’t partitioned, p is the palindrome partition for string before start index.<br>We use dp to store if a substring is a palindrome so that we do not have to check entire substring everytime we make a partition.<br>dp[i][j] is whether s i to j is a palindrome.<br>dp[i][j] is True if s[i]&#x3D;&#x3D;s[j], and dp[i+1][j-1] is True or the length of the substring is smaller than 3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">partition</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">str</span>]]:</span><br><span class="line">        dp=[[<span class="literal">False</span>]*<span class="built_in">len</span>(s) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line">        ans=[]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">helper</span>(<span class="params">s, start, p</span>):</span><br><span class="line">            <span class="keyword">nonlocal</span> dp</span><br><span class="line">            <span class="keyword">if</span> start&gt;=<span class="built_in">len</span>(s):</span><br><span class="line">                <span class="keyword">nonlocal</span> ans</span><br><span class="line">                ans.append(<span class="built_in">list</span>(p))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">for</span> end <span class="keyword">in</span> <span class="built_in">range</span>(start,<span class="built_in">len</span>(s)):</span><br><span class="line">                <span class="keyword">if</span> s[start]==s[end] <span class="keyword">and</span> (end - start &lt; <span class="number">2</span> <span class="keyword">or</span> dp[start+<span class="number">1</span>][end-<span class="number">1</span>]):</span><br><span class="line">                    dp[start][end] = <span class="literal">True</span></span><br><span class="line">                    p.append(s[start:end+<span class="number">1</span>])</span><br><span class="line">                    helper(s,end+<span class="number">1</span>,p)</span><br><span class="line">                    p.pop()</span><br><span class="line">        helper(s,<span class="number">0</span>,[])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/07/134-Gas-Station/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/07/134-Gas-Station/" itemprop="url">134. Gas Station</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-07T02:46:39-05:00">
                2023-01-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>There are n gas stations along a circular route, where the amount of gas at the ith station is gas[i].</p>
<p>You have a car with an unlimited gas tank and it costs cost[i] of gas to travel from the ith station to its next (i + 1)th station. You begin the journey with an empty tank at one of the gas stations.</p>
<p>Given two integer arrays gas and cost, return the starting gas station’s index if you can travel around the circuit once in the clockwise direction, otherwise return -1. If there exists a solution, it is guaranteed to be unique</p>
<p>For each station, we keep track of start index, total gas sum, and current gas in tank. If current gas in tank is below 0, means this station is unreachable with current staring index, set start index to be the next station.<br>In the end, if total gas left along all stations is below 0, means there is no answer, else we return the starting index we stores.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">canCompleteCircuit</span>(<span class="params">self, gas: <span class="type">List</span>[<span class="built_in">int</span>], cost: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line"></span><br><span class="line">        gasSum=<span class="number">0</span></span><br><span class="line">        current=<span class="number">0</span></span><br><span class="line">        ans=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(gas)):</span><br><span class="line">            gasSum+= gas[i] - cost[i]</span><br><span class="line">            current+= gas[i] - cost[i]</span><br><span class="line">            <span class="keyword">if</span> current &lt; <span class="number">0</span>:</span><br><span class="line">                current = <span class="number">0</span></span><br><span class="line">                ans = i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans <span class="keyword">if</span> gasSum&gt;=<span class="number">0</span> <span class="keyword">else</span> -<span class="number">1</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/130-Surrounded-Regions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/130-Surrounded-Regions/" itemprop="url">130. Surrounded Regions</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T20:07:58-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Given an m x n matrix board containing ‘X’ and ‘O’, capture all regions that are 4-directionally surrounded by ‘X’.</p>
<p>A region is captured by flipping all ‘O’s into ‘X’s in that surrounded region.</p>
<p>It is observed that all ‘O’ that is not connected to the boarders by ‘O’s will be flipped.<br>So we do a DFS for each ‘O’ on the boarder to mark all ‘O’s that is connected to the boarder, and flip the ones that is not marked</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">self, board</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :type board: List[List[str]]</span></span><br><span class="line"><span class="string">        :rtype: None Do not return anything, modify board in-place instead.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.ROWS = <span class="built_in">len</span>(board)</span><br><span class="line">        self.COLS = <span class="built_in">len</span>(board[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.ROWS):</span><br><span class="line">            self.DFS(board, i, <span class="number">0</span>)</span><br><span class="line">            self.DFS(board, i, self.COLS-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,self.COLS-<span class="number">1</span>):</span><br><span class="line">            self.DFS(board, <span class="number">0</span>, i)</span><br><span class="line">            self.DFS(board, self.ROWS-<span class="number">1</span>, i)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(self.ROWS):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(self.COLS):</span><br><span class="line">                <span class="keyword">if</span> board[r][c] == <span class="string">&#x27;O&#x27;</span>:   board[r][c] = <span class="string">&#x27;X&#x27;</span>  <span class="comment"># captured</span></span><br><span class="line">                <span class="keyword">elif</span> board[r][c] == <span class="string">&#x27;E&#x27;</span>: board[r][c] = <span class="string">&#x27;O&#x27;</span>  <span class="comment"># escaped</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">DFS</span>(<span class="params">self, board, row, col</span>):</span><br><span class="line">        <span class="keyword">if</span> board[row][col] != <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        board[row][col] = <span class="string">&#x27;E&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; self.COLS-<span class="number">1</span>: self.DFS(board, row, col+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> row &lt; self.ROWS-<span class="number">1</span>: self.DFS(board, row+<span class="number">1</span>, col)</span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>: self.DFS(board, row, col-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>: self.DFS(board, row-<span class="number">1</span>, col)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/129-Sum-Root-to-Leaf-Numbers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/129-Sum-Root-to-Leaf-Numbers/" itemprop="url">129. Sum Root to Leaf Numbers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T19:41:21-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>You are given the root of a binary tree containing digits from 0 to 9 only.</p>
<p>Each root-to-leaf path in the tree represents a number.</p>
<p>For example, the root-to-leaf path 1 -&gt; 2 -&gt; 3 represents the number 123.<br>Return the total sum of all root-to-leaf numbers. Test cases are generated so that the answer will fit in a 32-bit integer.</p>
<p>A leaf node is a node with no children.</p>
<p>Use DFS to traverse the nodes, if node is a leaf, add val to the sum.<br>If node is not a leaf, add val*10 to it’s children</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sumNumbers</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        sums=<span class="number">0</span></span><br><span class="line">        path=<span class="number">0</span></span><br><span class="line">        stack=[root] </span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            cur=stack.pop()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> cur.left <span class="keyword">and</span> <span class="keyword">not</span> cur.right:</span><br><span class="line">                sums+=cur.val</span><br><span class="line">            <span class="keyword">if</span> cur.right:</span><br><span class="line">                cur.right.val+=cur.val*<span class="number">10</span></span><br><span class="line">                stack.append(cur.right)</span><br><span class="line">            <span class="keyword">if</span> cur.left:</span><br><span class="line">                cur.left.val+=cur.val*<span class="number">10</span></span><br><span class="line">                stack.append(cur.left)</span><br><span class="line">        <span class="keyword">return</span> sums</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/128-Longest-Consecutive-Sequence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/128-Longest-Consecutive-Sequence/" itemprop="url">128. Longest Consecutive Sequence</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T19:18:48-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Given an unsorted array of integers nums, return the length of the longest consecutive elements sequence.</p>
<p>You must write an algorithm that runs in O(n) time.</p>
<p>In this question, dumplicate nums will not effect result, convert nums to set to have O(1) find.<br>For each number in set, if number-1 is not in set, means the number is the start of a consecutive sequence, count the length of the sequence by keep check if number + 1 is in the set.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">longestConsecutive</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        nums=<span class="built_in">set</span>(nums)</span><br><span class="line">        maxlength=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">            <span class="keyword">if</span> num-<span class="number">1</span> <span class="keyword">not</span> <span class="keyword">in</span> nums:</span><br><span class="line">                length=<span class="number">0</span></span><br><span class="line">                start=num</span><br><span class="line">                <span class="keyword">while</span> start <span class="keyword">in</span> nums:</span><br><span class="line">                    start+=<span class="number">1</span></span><br><span class="line">                    length+=<span class="number">1</span></span><br><span class="line">                maxlength=<span class="built_in">max</span>(maxlength,length)</span><br><span class="line">        <span class="keyword">return</span> maxlength</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/125-Valid-Palindrome/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/125-Valid-Palindrome/" itemprop="url">125. Valid Palindrome</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T17:32:20-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>A phrase is a palindrome if, after converting all uppercase letters into lowercase letters and removing all non-alphanumeric characters, it reads the same forward and backward. Alphanumeric characters include letters and numbers.</p>
<p>Given a string s, return true if it is a palindrome, or false otherwise.</p>
<p>First convert string s to all lower cases<br>Use two pointers where l go from left to right, right go from right to left<br>while l not greater than r<br>if both s[l] and s[r] are alphanumeric characters, check if they are the same, if not return False<br>move l one position right, and r one position left<br>if s[l] or s[r] is non-alphanumeric character, move l or r until an alphanumeric character is reached or l&gt;r since we don’t consider non-alphanumeric characters in this problem.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">isPalindrome</span>(<span class="params">self, s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        s=s.lower()</span><br><span class="line">        l=<span class="number">0</span></span><br><span class="line">        r=<span class="built_in">len</span>(s)-<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> l&lt;=r:</span><br><span class="line">            <span class="keyword">if</span> (s[l]&lt;<span class="string">&#x27;a&#x27;</span> <span class="keyword">or</span> s[l]&gt;<span class="string">&#x27;z&#x27;</span>) <span class="keyword">and</span> (s[l]&lt;<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> s[l]&gt;<span class="string">&#x27;9&#x27;</span>):</span><br><span class="line">                l+=<span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> (s[r]&lt;<span class="string">&#x27;a&#x27;</span> <span class="keyword">or</span> s[r]&gt;<span class="string">&#x27;z&#x27;</span>) <span class="keyword">and</span> (s[r]&lt;<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> s[r]&gt;<span class="string">&#x27;9&#x27;</span>):</span><br><span class="line">                r-=<span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> s[l]!=s[r]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            l+=<span class="number">1</span></span><br><span class="line">            r-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/124-Binary-Tree-Maximum-Path-Sum/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/124-Binary-Tree-Maximum-Path-Sum/" itemprop="url">124. Binary Tree Maximum Path Sum</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T16:39:51-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>A path in a binary tree is a sequence of nodes where each pair of adjacent nodes in the sequence has an edge connecting them. A node can only appear in the sequence at most once. Note that the path does not need to pass through the root.</p>
<p>The path sum of a path is the sum of the node’s values in the path.</p>
<p>Given the root of a binary tree, return the maximum path sum of any non-empty path.</p>
<p>For each node, compute the max positive path to this node in it’s left and right subtree<br>Check if left subtree + current node + right subtree is the max path so far, if so, update maxSum<br>return the max of left or right subtree path + current node, this will be the max path sum for the subtree with root be current node.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxPathSum</span>(<span class="params">self, root: <span class="type">Optional</span>[TreeNode]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">subPathSum</span>(<span class="params">root</span>):</span><br><span class="line">            <span class="keyword">nonlocal</span> maxSum</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            left = <span class="built_in">max</span>(subPathSum(root.left),<span class="number">0</span>)</span><br><span class="line">            right = <span class="built_in">max</span>(subPathSum(root.right),<span class="number">0</span>)</span><br><span class="line">            maxSum=<span class="built_in">max</span>(maxSum, left+right+root.val)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(left,right)+root.val</span><br><span class="line">        maxSum=-<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line">        subPathSum(root)</span><br><span class="line">        <span class="keyword">return</span> maxSum</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://haozhesun.github.io/2023/01/06/123-Best-Time-to-Buy-and-Sell-Stock-III/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Haozhe Sun's site">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/01/06/123-Best-Time-to-Buy-and-Sell-Stock-III/" itemprop="url">123. Best Time to Buy and Sell Stock III</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-01-06T15:50:19-05:00">
                2023-01-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">Leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>You are given an array prices where prices[i] is the price of a given stock on the ith day.</p>
<p>Find the maximum profit you can achieve. You may complete at most two transactions.</p>
<p>Note: You may not engage in multiple transactions simultaneously (i.e., you must sell the stock before you buy again).</p>
<p>Use dpl where dpl[i] stores the max profit for prices[0] to price[i]<br>dpl[i] is equal to the maximum between prices[i-1] and price[i] - minleft<br>Use dpr where dpr[i] stores the max profit for prices[i:]<br>dpr[i] is equal to the maximum between prices[i+1] and maxright - price[i]</p>
<p>This way, we sepereate the prices in to left and right part, while dpl is max profit of one transaction in left part, dpr is for the right part<br>The max profit would be the max of the sum between dpl[i] and dpr[i] for all i in range len(prices)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxProfit</span>(<span class="params">self, prices: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices <span class="keyword">or</span> <span class="built_in">len</span>(prices)&lt;<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        maxright=prices[-<span class="number">1</span>]</span><br><span class="line">        dp=[<span class="number">0</span>]*<span class="built_in">len</span>(prices)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(prices)-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> prices[i]&gt;maxright:</span><br><span class="line">                maxright=prices[i]</span><br><span class="line">            <span class="keyword">if</span> prices[i]&gt;prices[i+<span class="number">1</span>]:</span><br><span class="line">                dp[i]=dp[i+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dp[i]=<span class="built_in">max</span>(dp[i+<span class="number">1</span>],maxright-prices[i])</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">30</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/HaozheSun" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:sunhaozhe.sun@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Haozhe Sun</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
